<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bible Quiz</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="quiz-layout">
    <div id="timer-sidebar">
      <h3>Time Left</h3>
      <div class="timer-container">
        <div class="timer-bar" id="timer-bar"></div>
      </div>
      <p id="timer"><span id="time">40:00</span></p>
    </div>

    <div id="quiz-container">
      <h2>Question:</h2>
      <div id="question-container"></div>

      <div style="margin-top: 20px;">
        <button id="prev-btn">Previous</button>
        <button id="next-btn">Next</button>
        <button id="submit-btn" style="display: none;">Submit Quiz</button>
      </div>
    </div>
  </div>

  <script>
  const questions = [

            {
                text: "How many children did Judah have?",
                options: { A: "3", B: "4", C: "5", D: "6" },
                answer: "B"
            },
            {
                text: "Who was Jesus' grandfather?",
                options: { A: "Anui", B: "Heli", C: "Joseph", D: "David" },
                answer: "B"
            },
            {
                text: "Which prophet confronted the King David after his sin with Bathsheba?",
                options: { A: "Nathan", B: "Elijah", C: "Elisha", D: "Samuel" },
                answer: "A"
            },
            {
                text: "In the Song of Solomon, how much is the bride’s dowry?",
                options: { A: "5,000 silver pieces", B: "10,000 silver pieces", C: "2,000 silver pieces", D: "1,000 silver pieces" },
                answer: "D"
            },
            {
                text: "The high priest of Jerusalem that put Jesus on trial, what was his name",
                options: { A: "Herod", B: "Pilate", C: "Caiaphas", D: "Ceasar" },
                answer: "C"
            },
            {
                text: "Which book comes directly after the Gospels?",
                options: { A: "Romans", B: "Acts", C: "Exodus", D: "Revelation" },
                answer: "B"
            },
            {
                text: "How many plagues are in exodus?",
                options: { A: "6", B: "10", C: "7", D: "12" },
                answer: "B"
            },
            {
                text: "How many books are in the Bible?",
                options: { A: "66", B: "72", C: "39", D: "27" },
                answer: "A"
            },
            {
                text: "Which group was the ruling council of the Jews that plotted Jesus’ death?",
                options: { A: "The Manhattan", B: "The Sanhedrin", C: "Ceasar's Army", D: "The Jews" },
                answer: "B"
            },
            {
                text: "Paul is from what tribe?",
                options: { A: "Judah", B: "Levi", C: "Joseph", D: "Benjamin" },
                answer: "D"
            },
            {
                text: "Jesus’ meeting of a woman at Jacob’s well was in which town?",
                options: { A: "Sychar", B: "Capernaum", C: "Galilee", D: "Haran" },
                answer: "A"
            },
            {
                text: "Which group was the ruling council of the Jews that plotted Jesus’ death?",
                options: { A: "The Manhattan", B: "The Sanhedrin", C: "Ceasar's Army", D: "The Benjamites" },
                answer: "B"
            },
            {
                text: "At the time of Jesus’ birth, which roman was in charge of cultivation at Syria?",
                options: {A: "Sychar", B: "Cyrenius", C: "Hananiel", D: "Aquilla" },
                answer: "B"
            },
            {
                text: "What is the name of the well Abraham and Abimelech fought over?",
                options: {A: "Bathsheba", B: "Beersheba", C: "Sheba", D: "The wilderness and the land of Sodom"},
                answer: "B"
            },
            {
                text: "Which place is called “Zion” and “the city of David”?",
                options: {A: "Judaea", B: "Galilee", C: "Hebron", D: "Jerusalem" },
                answer: "D"
            },
            {
                text: "Who was the first high priest of Israel?",
                options: {A: "Aaron", B: "Eliezer", C: "Phinehas", D: "Melchizedek" },
                answer: "A"
            },
            {
                text: "Which king of Judah was struck with leprosy for usurping the role of a priest?",
                options: {A: "Uzziah", B: "Hezekiah", C: "Manasseh", D: "Josiah" },
                answer: "A"
            },
            {
                text: "Lebanon was popular for which kind of tree?",
                options: {A: "Poplar Tree", B: "Fig Tree", C: "Cedar Tree", D: "Shale Tree" },
                answer: "C"
            },
            {
                text: "What illness was Mephibosheth suffering from?",
                options: {A: "Lameness", B: "Leprosy", C: "Blindness", D: "Dumbness" },
                answer: "B"
            },
            {
                text: "Timotheus grandmother was called?",
                options: {A: "Lois", B: "Maria", C: "Zeruja", D: "Bernice" },
                answer: "A"
            },
            {
                text: "Apostle Paul on the Areopagus or the execution of Jacob, which happened first?",
                options: {A: "The execution of Judah", B: "Both", C: "The execution of Jacob", D: "Apostle Paul on the Areopagus" },
                answer: "C"
            },
            {
                text: "Peter’s first letter was addressed to who?",
                options: {A: "Timotheus", B: "Dispersed Christians", C: "Dispersed Strangers", D: "The church in Corinth" },
                answer: "C"
            },
            {
                text: "Which prophet predicted a ruler out of Bethlehem Ephrathah?",
                options: {A: "Prophet Micah", B: "Prophet Isaiah", C: "Prophet Zechariah", D: "John the baptist"},
                answer: "A"
            },
            {
                text: "What is the name of David’s chief counselor?",
                options: {A: "Ahithophel", B: "Harbonah", C: "Nathan", D: "Micaiah" },
                answer: "A"
            },
            {
                text: "David wrote the entire book of Psalms",
                options: {A: "True", B: "False" },
                answer: "B"
            },
            {
                text: "Which human author wrote the most books?",
                options: {A: "David (150)", B: "Paul (15)", C: "Daniel (14)", D: "Paul (13)"},
                answer: "D"
            },
            {
                text: "The spies sent into the land of Canaan, what did they see that made them scared?",
                options: {A: "Lions", B: "A great army", C: "The soldeirs", D: "Giants"},
                answer: "D"
            },
            {
                text: "How many people saw Jesus after he came back from the dead?",
                options: {A: "Over 100 people", B: "Below 100 people", C: "Over 500 people", D: "Below 500 people"},
                answer: "C"
            },
            {
                text: "Where did Peter stay during his ministry in the city of Joppa?",
                options: {A: "In the house of Simon the tanner", B: "In the church at Joppa", C: "At Talitha Dorcas' House", D: "At the temple in Genasaret"},
                answer: "A"
            },
            {
                text: "What was the name of Job’s mother?",
                options: {A: "Lois", B: "Maria", C: "Zeruja", D: "Bernice" },
                answer: "C"
            },
            {
                text: "Ezra had what job position in Israel?",
                options: {A: "Land Surveyor", B: "Land Seller", C: "Chief Cultivator", D: "Land Cultivator" },
                answer: "D"
            },
            {
                text: "What did Jacob call the place he fought God?",
                options: {A: "Maranatha", B: "Peniel", C: "Bethel", D: "Rehoboth" },
                answer: "B"
            },
            {
                text: "Where in the bible can you find the Lord’s prayer?",
                options: {A: "Matthew 3", B: "Matthew 8", C: "Matthew 5", D: "Matthew 6"},
                answer: "D"
            },
            {
                text: "How many deacons were chosen to help the apostles to distribute food to widows?",
                options: {A: "10", B: "5", C: "7", D: "12"},
                answer: "C"
            },
            {
                text: "What was John the Baptist’s cloth made out of?",
                options: {A: "Jaguar skin", B: "Cow skin", C: "Horse hair", D: "Camel hair"},
                answer: "D"
            },
            {
                text: "Who worked as a tax collector before preaching the word of God?",
                options: {A: "Zaccheus", B: "Matthew", C: "Phillip", D:"Ananias"},
                answer: "B"
            }
      
          ];
    let shuffledQuestions = [];
    let currentQuestionIndex = 0;
    let answers = {};
    let viewedQuestions = new Set();
    let timerInterval;

    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    function loadQuestion() {
      const question = shuffledQuestions[currentQuestionIndex];
      viewedQuestions.add(currentQuestionIndex); // mark this question as viewed

      const container = document.getElementById('question-container');
      const selected = answers[currentQuestionIndex];

      container.innerHTML = `
        <p>${currentQuestionIndex + 1}. ${question.text}</p>
        ${Object.entries(question.options).map(([key, val]) =>
          `<label><input type="radio" name="answer" value="${key}" ${selected === key ? 'checked' : ''}> ${val}</label><br>`).join('')}
      `;

      container.querySelectorAll('input[type="radio"]').forEach(radio => {
        radio.addEventListener('change', () => {
          answers[currentQuestionIndex] = radio.value;
        });
      });

      checkViewCount();

      document.getElementById('prev-btn').disabled = currentQuestionIndex === 0;
      document.getElementById('next-btn').disabled = currentQuestionIndex === shuffledQuestions.length - 1;
    }

    function checkViewCount() {
      if (viewedQuestions.size >= 20) {
        document.getElementById('submit-btn').style.display = 'inline-block';
      }
    }

    function startQuiz() {
      shuffledQuestions = [...questions];
      shuffleArray(shuffledQuestions);
      shuffledQuestions = shuffledQuestions.slice(0, 40);
      loadQuestion();
      startTimer(40 * 60);
    }

    function startTimer(duration) {
      let timeLeft = duration;
      const display = document.getElementById('time');
      const bar = document.getElementById('timer-bar');

      timerInterval = setInterval(() => {
        const minutes = Math.floor(timeLeft / 60);
        const seconds = timeLeft % 60;
        display.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

        const percentage = (timeLeft / duration) * 100;
        bar.style.width = `${percentage}%`;

        if (--timeLeft < 0) {
          clearInterval(timerInterval);
          submitQuiz();
        }
      }, 1000);
    }

    function submitQuiz() {
      const username = localStorage.getItem("currentUser");
      const score = Object.values(answers).filter(Boolean).length; // still recorded for admin
      const date = new Date().toLocaleString();

      let results = JSON.parse(localStorage.getItem("quizResults")) || [];
      results.push({ username, score, date });
      localStorage.setItem("quizResults", JSON.stringify(results));

      window.location.href = "thankyou.html";
    }

    document.getElementById('next-btn').addEventListener('click', () => {
      if (currentQuestionIndex < shuffledQuestions.length - 1) {
        currentQuestionIndex++;
        loadQuestion();
      }
    });

    document.getElementById('prev-btn').addEventListener('click', () => {
      if (currentQuestionIndex > 0) {
        currentQuestionIndex--;
        loadQuestion();
      }
    });

    document.getElementById('submit-btn').addEventListener('click', submitQuiz);

    window.addEventListener('beforeunload', () => {
      clearInterval(timerInterval);
    });

    document.addEventListener('visibilitychange', () => {
      if (document.hidden) {
        clearInterval(timerInterval);
        submitQuiz();
      }
    });

    startQuiz();
  </script>
</body>
</html>

